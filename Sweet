Perfect ‚Äî I can see from your screenshot that:

tcp6   0   0 :::10256   :::*   LISTEN   279856/kube-proxy  
tcp6   0   0 :::10250   :::*   LISTEN   279567/kubelet

‚úÖ That confirms the Nessus vulnerability (SWEET32) is coming from the Kubelet service (port 10250) on your worker node (10.57.12.118).

Let‚Äôs fix that properly üëá

‚∏ª

üõ† Step-by-Step Fix ‚Äî Disable Weak SSL Ciphers in Kubelet (Worker Node)

1Ô∏è‚É£ Edit the Kubelet configuration file

Find the kubelet config path:

systemctl cat kubelet | grep -i config

You‚Äôll likely see something like:

--config=/var/lib/kubelet/config.yaml

Then open that file:

sudo vi /var/lib/kubelet/config.yaml


‚∏ª

2Ô∏è‚É£ Add or modify the TLS configuration section

Under the main YAML keys, add (or update) these lines:

tlsMinVersion: VersionTLS12
tlsCipherSuites:
  - TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
  - TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
  - TLS_AES_256_GCM_SHA384

‚ö†Ô∏è Ensure correct indentation (2 spaces per level).
If you already see tlsMinVersion or tlsCipherSuites, just replace the old values.

‚∏ª

3Ô∏è‚É£ Save and restart the kubelet service

sudo systemctl daemon-reexec
sudo systemctl restart kubelet


‚∏ª

4Ô∏è‚É£ Validate that kubelet restarted cleanly

sudo systemctl status kubelet

You should see ‚Äúactive (running)‚Äù.

‚∏ª

5Ô∏è‚É£ Verify with SSL cipher scan

From another machine or using nmap locally:

nmap --script ssl-enum-ciphers -p 10250 10.57.12.118

‚úÖ Expected result:
Only TLSv1.2 or TLSv1.3 ciphers, and no 3DES/DES/SHA1.

‚∏ª

6Ô∏è‚É£ (Optional) Disable the read-only port (10255) if still active

Add this line in the same config file:

readOnlyPort: 0

Then restart kubelet again.

‚∏ª

üß© Final Kubelet config snippet (secure example)

Here‚Äôs how your /var/lib/kubelet/config.yaml should look after update:

kind: KubeletConfiguration
apiVersion: kubelet.config.k8s.io/v1beta1
address: 0.0.0.0
readOnlyPort: 0
tlsMinVersion: VersionTLS12
tlsCipherSuites:
  - TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
  - TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
  - TLS_AES_256_GCM_SHA384
authentication:
  anonymous:
    enabled: false


‚∏ª

Would you like me to show you exactly how your existing /var/lib/kubelet/config.yaml should look after editing (based on your current cluster‚Äôs setup)?
If you paste or upload that file, I‚Äôll mark the exact lines to change safely.
